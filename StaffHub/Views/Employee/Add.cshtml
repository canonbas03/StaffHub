@model StaffHub.Models.Employee

<h1>Add new employee:</h1>
<form asp-action="Add" method="post">
    <div class="form-group">
        <label asp-for="FirstName">First Name:</label>
        <input asp-for="FirstName" class="form-control" />
        <span asp-validation-for="FirstName" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="LastName">Last Name:</label>
        <input asp-for="LastName" class="form-control" />
        <span asp-validation-for="LastName" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Salary">Salary:</label>
        <input asp-for="Salary" class="form-control" />
        <span asp-validation-for="Salary" class="text-danger"></span>
    </div>
    <div class="form-group">
        <h1>Department</h1>
        <select id="DepartmentId" name="DepartmentId" class="form-control">
            <option value="">--Select--</option>
            @foreach (var dept in ViewBag.Departments)
            {
                <option value="@dept.DepartmentId">@dept.Name</option>
            }

        </select>
    </div>
    <div class="form-group">
        <h1>Roles</h1>
        <select id="RoleId" name="RoleId" class="form-control">
            <option value="">--Select--</option>
        </select>
    </div>
    <button type="submit">Save</button>
    <a asp-action="List">Back</a>
</form>
<script>
    document.getElementById("DepartmentId").addEventListener("change",function(){
        var deptId = this.value;
        fetch(`/Employee/GetRolesByDepartment/${deptId}`)
        .then(response => response.json())
        .then(data => {
            var roleDropdown = document.getElementById("RoleId");
            roleDropdown.innerHTML = `<option value="">--Select--</option>`;
            data.forEach(r=>{
                var option = document.createElement("option");
                option.value = r.roleId;
                option.text = r.name;
                roleDropdown.appendChild(option);
            });
        });

    });
</script>